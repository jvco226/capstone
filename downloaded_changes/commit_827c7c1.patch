commit 827c7c14b1b499ec8f842602d2af7baa4e6503f7
Author: jvco226 <jvco226@uky.edu>
Date:   Tue Dec 9 12:40:55 2025 -0500

    Add files via upload

diff --git a/index.html b/index.html
index fbbd563..f2ca051 100644
--- a/index.html
+++ b/index.html
@@ -37,6 +37,7 @@
     <div class="w-full max-w-lg bg-white rounded-xl shadow-2xl overflow-hidden">
         <nav class="bg-red-700 text-white p-4 flex justify-center space-x-6">
             <button id="nav-home" class="nav-link px-4 py-1 text-xl rounded-md font-bold hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-400" data-page="home-page">Home</button>
+            <button id="nav-login" class="nav-link px-4 py-1 text-xl rounded-md font-bold hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-400" data-page="login-page">Login</button>
             <button id="nav-register" class="nav-link px-4 py-1 text-xl rounded-md font-bold hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-400" data-page="register-page">Register</button>
         </nav>
 
@@ -48,6 +49,9 @@
         <div class="p-6 md:p-8">
             <!-- Home Page -->
             <div id="home-page" class="page-content">
+                <p id="logged-in-user" class="text-sm text-gray-600 text-center mb-2 hidden">
+                    You're logged in as <span id="username-display" class="font-semibold"></span>
+                </p>
                 <h1 class="text-6xl font-black mb-6 text-center text-red-600">Online Trivia ðŸ“š</h1>
 
                 <div class="space-y-8">
@@ -66,8 +70,14 @@
                         <span class="flex-shrink mx-4 text-gray-500">OR</span>
                         <div class="flex-grow border-t border-gray-300"></div>
                     </div>
-
-                    <!-- Join a Game -->
+                    <!-- Public Game -->
+                    <div class="text-center">
+                        <h2 class="text-2xl font-bold mb-3 text-gray-700">Join a Public Game!</h2>
+                        <button id="join-public-btn" class="w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-lg font-bold uppercase tracking-wider text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-400">
+                            Join Public Game
+                         </button>
+                    </div>
+                    <!-- Privatge Game -->
                     <div>
                         <h2 class="text-2xl font-bold mb-3 text-gray-700 text-center">Join a Game!</h2>
                         <form id="join-form" class="space-y-4" novalidate>
@@ -82,7 +92,7 @@
                             </div>
                             <button type="submit"
                                     class="w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-lg font-bold uppercase tracking-wider text-white bg-blue-500 hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-400">
-                                Join Room
+                                Join Private Room
                             </button>
                         </form>
                     </div>
@@ -110,6 +120,30 @@
                 </form>
             </div>
 
+            <!-- Login Page -->
+            <div id="login-page" class="page-content hidden">
+                <h1 class="text-3xl font-black mb-6 text-center text-red-700">Login to Your Account</h1>
+                <form id="login-form" class="space-y-4">
+                    <div>
+                        <label for="login-username" class="block text-sm font-bold text-gray-700">Username</label>
+                        <input type="text" id="login-username" name="username" required
+                               class="mt-1 block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-lg">
+                    </div>
+
+                    <div>
+                        <label for="login-password" class="block text-sm font-bold text-gray-700">Password</label>
+                        <input type="password" id="login-password" name="password" required
+
+                               class="mt-1 block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-lg">
+
+                    </div>
+                    <button type="submit"
+                            class="w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-lg font-bold uppercase tracking-wider text-white bg-blue-500 hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-400">
+                        Login
+                    </button>
+                </form>
+
+            </div>
             <!-- Lobby Page -->
             <div id="lobby-page" class="page-content hidden">
                 <h1 class="text-4xl font-black mb-6 text-center text-red-600">Lobby</h1>
@@ -127,222 +161,286 @@
                     <!-- PLACEHOLDER player list -->
                     <div id="player-list" class="min-h-[100px] bg-white border border-gray-200 rounded-lg p-3 text-left mb-6">
                         <h3 class="font-bold text-gray-800 text-lg mb-2">Players (1/8)</h3>
-                        <!-- Player names will be added by JS later -->
                         <ul id="players" class="list-disc list-inside">
                             <li>Host</li>
                         </ul>
                     </div>
-                    <button id="start-game-btn"
-                            class="w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-lg font-bold uppercase tracking-wider text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-400">
-                        Start Game!
-                    </button>
+                    <div class="grid grid-cols-2 gap-4">
+                        <button id="leave-lobby-btn"
+                                class="w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-lg font-bold uppercase tracking-wider text-white bg-red-500 hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-400">
+                            Leave Lobby
+                        </button>
+                        <button id="start-game-btn"
+                                class="w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-lg font-bold uppercase tracking-wider text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-400">
+                            Start Game!
+                        </button>
+                    </div>
                 </div>
+            </div>
+
 
             </div>
         </div>
     </div>
 
+    <!-- Socket.IO client -->
+    <script src="/socket.io/socket.io.js"></script>
+
     <script>
-        document.addEventListener('DOMContentLoaded', () => {
-            // Page containers
-            const pages = document.querySelectorAll('.page-content');
-            const navContainer = document.querySelector('nav');
-            
-            // Forms and Buttons
-            const registerForm = document.getElementById('register-form');
-            const createRoomBtn = document.getElementById('create-room-btn');
-            const joinForm = document.getElementById('join-form');
-            const startGameBtn = document.getElementById('start-game-btn');
-
-            // Message Box
-            const messageBox = document.getElementById('message-box');
-            const messageText = document.getElementById('message-text');
-            const closeMessageBtn = document.getElementById('close-message');
-
-            // Dynamic Content
-            const lobbyGamePin = document.getElementById('lobby-game-pin');
-            const gamePinInput = document.getElementById('game-pin')
-
-            let messageTimeout;
-
-            // Utility Functions
-
-            function showPage(pageId) {
-                pages.forEach(page => {
-                    page.classList.add('hidden');
+    document.addEventListener('DOMContentLoaded', () => {
+        // create socket after socket.io script is loaded
+        let socket = io();
+
+        // Page containers
+        const pages = document.querySelectorAll('.page-content');
+        const navContainer = document.querySelector('nav');
+
+        // Forms and Buttons
+        const registerForm = document.getElementById('register-form');
+        const loginForm = document.getElementById('login-form');
+        const createRoomBtn = document.getElementById('create-room-btn');
+        const joinForm = document.getElementById('join-form');
+        const startGameBtn = document.getElementById('start-game-btn');
+        const leaveLobbyBtn = document.getElementById('leave-lobby-btn');
+
+        // Message Box
+        const messageBox = document.getElementById('message-box');
+        const messageText = document.getElementById('message-text');
+        const closeMessageBtn = document.getElementById('close-message');
+
+        // Lobby
+        const lobbyGamePin = document.getElementById('lobby-game-pin');
+        const playerListContainer = document.getElementById('player-list');
+        const playersUl = document.getElementById('players');
+
+        // Input
+        const gamePinInput = document.getElementById('game-pin');
+
+        // Globals
+        let messageTimeout;
+        let username = null;
+        let players = [];
+        let currentRoomCode = null;
+
+        // --- Utility Functions ---
+        function showPage(pageId) {
+            pages.forEach(page => page.classList.add('hidden'));
+            const activePage = document.getElementById(pageId);
+            if (activePage) activePage.classList.remove('hidden');
+            hideMessage();
+        }
+
+        const joinPublicBtn = document.getElementById('join-public-btn');
+
+        joinPublicBtn.addEventListener('click', async () => {
+            showMessage('Finding a public game...', 'info');
+            try {
+                const response = await fetch('/api/join-public-room', {
+                    method: 'POST',
+                    headers: { 'Content-Type': 'application/json' },
+                    body: JSON.stringify({ playerName: username || 'Guest' })
                 });
-                const activePage = document.getElementById(pageId);
-                if (activePage) {
-                    activePage.classList.remove('hidden');
-                }
-                hideMessage(); 
+                const data = await response.json();
+                if (!response.ok) return showMessage(data.error || 'Could not join public room.', 'error');
+
+                socket.emit('joinRoom', { code: data.code, playerName: username || 'Guest' });
+            } catch {
+                showMessage('An error occurred. Please try again.', 'error');
             }
+        });
 
-            function showMessage(message, type = 'info') {
-                if (messageTimeout) {
-                    clearTimeout(messageTimeout);
-                }
+        const loggedInUser = document.getElementById('logged-in-user');
+        const usernameDisplay = document.getElementById('username-display');
 
-                messageText.textContent = message;
-                messageBox.classList.remove('hidden', 'bg-green-600', 'bg-red-500', 'text-white');
-                
-                if (type === 'success') {
-                    messageBox.classList.add('bg-green-600', 'text-white');
-                } else if (type === 'error') {
-                    messageBox.classList.add('bg-red-500', 'text-white');
-                } else { // info
-                    messageBox.classList.add('bg-green-600', 'text-white');
-                }
-
-                messageTimeout = setTimeout(hideMessage, 5000);
+        function updateLoggedInDisplay() {
+            if (username) {
+                usernameDisplay.textContent = username;
+                loggedInUser.classList.remove('hidden');
+            } else {
+                loggedInUser.classList.add('hidden');
             }
+        }
 
-            function hideMessage() {
-                if (messageTimeout) {
-                    clearTimeout(messageTimeout);
-                }
-                messageBox.classList.add('hidden');
-            }
+        function showMessage(message, type = 'info') {
+            if (messageTimeout) clearTimeout(messageTimeout);
+            messageText.textContent = message;
+            messageBox.classList.remove('hidden', 'bg-green-600', 'bg-red-500', 'text-white');
+            if (type === 'success') messageBox.classList.add('bg-green-600', 'text-white');
+            else if (type === 'error') messageBox.classList.add('bg-red-500', 'text-white');
+            else messageBox.classList.add('bg-green-600', 'text-white');
+            messageTimeout = setTimeout(hideMessage, 5000);
+        }
+
+        function hideMessage() {
+            if (messageTimeout) clearTimeout(messageTimeout);
+            messageBox.classList.add('hidden');
+        }
 
-            gamePinInput.addEventListener('input', (e) => {
-                // Don't allow non-numeral input
-                e.target.value = e.target.value.replace(/\D/g, '');
+        function updatePlayerList() {
+            playersUl.innerHTML = '';
+            players.forEach(p => {
+                const li = document.createElement('li');
+                li.textContent = p;
+                playersUl.appendChild(li);
             });
+            const countText = `Players (${players.length}/8)`;
+            playerListContainer.querySelector('h3').textContent = countText;
+        }
 
-            // Event Listeners
+        // --- Event Listeners ---
+        gamePinInput.addEventListener('input', (e) => {
+            e.target.value = e.target.value.replace(/\D/g, '');
+        });
 
-            // Top Navigation (Home and Register)
-            navContainer.addEventListener('click', (e) => {
-                const link = e.target.closest('.nav-link'); 
-                
-                if (link) {
-                    const pageId = link.getAttribute('data-page');
-                    if (pageId) {
-                        showPage(pageId);
-                    }
-                }
-            });
+        navContainer.addEventListener('click', (e) => {
+            const link = e.target.closest('.nav-link');
+            if (link) {
+                const pageId = link.getAttribute('data-page');
+                if (pageId) showPage(pageId);
+            }
+        });
 
-            closeMessageBtn.addEventListener('click', hideMessage);
-
-            
-            registerForm.addEventListener('submit', async (e) => {
-                e.preventDefault(); 
-                const username = document.getElementById('username').value;
-                const password = document.getElementById('password').value;
-
-                if (!username || !password) {
-                    showMessage('Username and password are required.', 'error');
-                    return;
-                }
-
-                showMessage('Registering...', 'info');
-
-                try {
-                    const response = await fetch('/api/register', {
-                        method: 'POST',
-                        headers: { 'Content-Type': 'application/json' },
-                        body: JSON.stringify({ username, password }),
-                    });
-
-                    const data = await response.json();
-
-                    if (response.ok) {
-                        showMessage('Registration successful!', 'success');
-                        registerForm.reset();
-                        showPage('home-page'); // Go back home after registering
-                    } else {
-                        showMessage(data.error || 'Registration failed.', 'error');
-                    }
-                } catch (error) {
-                    console.error('Registration Error:', error);
-                    showMessage('An error occurred. Please try again.', 'error');
-                }
-            });
-            
+        closeMessageBtn.addEventListener('click', hideMessage);
+
+        // Registration
+        registerForm.addEventListener('submit', async (e) => {
+            e.preventDefault(); 
+            const regUser = document.getElementById('username').value;
+            const regPass = document.getElementById('password').value;
+            if (!regUser || !regPass) return showMessage('Username and password are required.', 'error');
+            showMessage('Registering...', 'info');
+
+            try {
+                const response = await fetch('/api/register', {
+                    method: 'POST',
+                    headers: { 'Content-Type': 'application/json' },
+                    body: JSON.stringify({ username: regUser, password: regPass }),
+                });
+                const data = await response.json();
+                if (response.ok) {
+                    showMessage('Registration successful!', 'success');
+                    registerForm.reset();
+                    showPage('home-page');
+                } else showMessage(data.error || 'Registration failed.', 'error');
+            } catch {
+                showMessage('An error occurred. Please try again.', 'error');
+            }
+        });
 
-            createRoomBtn.addEventListener('click', async () => {
-                
-                showMessage('Hosting new game...', 'info');
-
-                try {
-                    const response = await fetch('/api/create-room', {
-                        method: 'POST',
-                    });
-
-                    const data = await response.json();
-
-                    if (response.ok && data.code) {
-                        if (lobbyGamePin) {
-                            lobbyGamePin.textContent = data.code;
-                        }
-                        showMessage(`Game ${data.code} created!`, 'success');
-                        showPage('lobby-page');
-                        
-                        // Connect to WebSocket here
-                        // connectToWebSocket(data.code, "HostName");
-
-                    } else {
-                        showMessage(data.error || 'Failed to create game.', 'error');
-                    }
-                } catch (error) {
-                    console.error('Host Game Error:', error);
-                    showMessage('An error occurred. Please try again.', 'error');
-                }
-            });
-            
-
-            joinForm.addEventListener('submit', async (e) => {
-                e.preventDefault();
-                const pin = gamePinInput.value;
-
-                const pinRegex = /^\d{6}$/;
-                if(!pinRegex.test(pin)){
-                    showMessage ('PIN must be 6 digits.', 'error');
-                    return;
-                }
-                if (!pin) {
-                    showMessage('Please enter a Game PIN.', 'error');
-                    return;
-                }
-
-                showMessage(`Checking game ${pin}...`, 'info');
-
-                try {
-                    const response = await fetch('/api/join-room', {
-                        method: 'POST',
-                        headers: { 'Content-Type': 'application/json' },
-                        body: JSON.stringify({ code: pin, playerName: 'Guest' }), // Need to implement player name input
-                    });
-
-                    const data = await response.json();
-
-                    if (!response.ok) {
-                        showMessage(data.error || 'Could not join room.', 'error');
-                    } else {
-                        if (lobbyGamePin) {
-                            lobbyGamePin.textContent = pin.toUpperCase();
-                        }
-                        showPage('lobby-page'); 
-                        showMessage('Room found!', 'success');
-                        
-                        // Connect to the WebSocket
-                        // connectToWebSocket(data.code, "YourName"); 
-                    }
-                } catch (error) {
-                    console.error('Join Game Error:', error);
-                    showMessage('An error occurred. Please try again.', 'error');
-                }
-            });
+        // Login
+        loginForm.addEventListener('submit', async (e) => {
+            e.preventDefault();
+            const loginUser = document.getElementById('login-username').value;
+            const loginPass = document.getElementById('login-password').value;
+            if (!loginUser || !loginPass) return showMessage('Username and password are required.', 'error');
+            showMessage('Logging in...', 'info');
+
+            try {
+                const response = await fetch('/api/login', {
+                    method: 'POST',
+                    headers: { 'Content-Type': 'application/json' },
+                    body: JSON.stringify({ username: loginUser, password: loginPass }),
+                });
+                const data = await response.json();
+
+                if (response.ok) {
+                    username = loginUser;
+                    showMessage(`Welcome back, ${username}!`, 'success');
+                    updateLoggedInDisplay();
+                    loginForm.reset();
+                    showPage('home-page');
+                } else showMessage(data.error || 'Login failed. Check credentials.', 'error');
+            } catch {
+                showMessage('An error occurred. Please try again.', 'error');
+            }
+        });
+
+        // Create Room (Host)
+        createRoomBtn.addEventListener('click', async () => {
+            showMessage('Hosting new game...', 'info');
+            try {
+                const response = await fetch('/api/create-room', { method: 'POST' });
+                const data = await response.json();
+                if (response.ok && data.code) {
+                    lobbyGamePin.textContent = data.code;
+                    showPage('lobby-page');
+                    socket.emit('joinRoom', { code: data.code, playerName: username || 'Host' });
+                    showMessage(`Game ${data.code} created!`, 'success');
+                } else showMessage(data.error || 'Failed to create game.', 'error');
+            } catch {
+                showMessage('An error occurred. Please try again.', 'error');
+            }
+        });
+
+        // Join Room
+        joinForm.addEventListener('submit', async (e) => {
+            e.preventDefault();
+            const pin = gamePinInput.value.trim();
+            if (!/^\d{6}$/.test(pin)) return showMessage('PIN must be 6 digits.', 'error');
+            showMessage(`Checking game ${pin}...`, 'info');
+
+            try {
+                const response = await fetch('/api/join-room', {
+                    method: 'POST',
+                    headers: { 'Content-Type': 'application/json' },
+                    body: JSON.stringify({ code: pin, playerName: username || 'Guest' }),
+                });
+                const data = await response.json();
 
+                if (!response.ok) return showMessage(data.error || 'Could not join room.', 'error');
+
+                socket.emit('joinRoom', { code: pin, playerName: username || 'Guest' });
+            } catch {
+                showMessage('An error occurred. Please try again.', 'error');
+            }
 
-            startGameBtn.addEventListener('click', () => {
-                showMessage('Starting game!', 'info');
-                console.log('Start game button clicked.');
+            socket.on('joinError', (msg) => {
+                showMessage(msg, 'error');
             });
 
+        });
+
+        // Listen for server confirmation
+        socket.on('joinSuccess', ({ code, players: serverPlayers }) => {
+            currentRoomCode = code;
+            lobbyGamePin.textContent = code;
+            players = serverPlayers.map(p => p.name);
+            updatePlayerList();
+            showPage('lobby-page');
+            showMessage('Room joined!', 'success');
+        });
+
+        // Listen for join errors
+        socket.on('joinError', (message) => {
+            showMessage(message, 'error');
+        })
+
+        // Listen for server broadcasts of the player list
+        socket.on('updatePlayers', (playerList) => {
+            players = playerList.map(p => p.name);
+            updatePlayerList();
+        });
+
+        // Leave Lobby
+        leaveLobbyBtn.addEventListener('click', () => {
+            if (currentRoomCode) {
+                socket.emit('leaveRoom', currentRoomCode);
+                currentRoomCode = null;
+            }
+
+            players = [];
+            updatePlayerList();
             showPage('home-page');
+            showMessage('You left the lobby.', 'success');
+        });
+
+        // Start Game
+        startGameBtn.addEventListener('click', () => {
+            showMessage('Starting game!', 'info');
+            console.log('Start game button clicked.');
         });
-    </script>
-</body>
-</html>
\ No newline at end of file
+
+        // Initial view
+        showPage('home-page');
+    });
+</script>
diff --git a/init.sql b/init.sql
new file mode 100644
index 0000000..12cd564
--- /dev/null
+++ b/init.sql
@@ -0,0 +1,36 @@
+-- Create users table for login / scores extension
+CREATE TABLE IF NOT EXISTS users (
+    id SERIAL PRIMARY KEY,
+    username VARCHAR(50) UNIQUE NOT NULL,
+    password_hash VARCHAR(255) NOT NULL
+);
+
+-- App user used by the Node backend (not the admin account)
+DO
+$$
+BEGIN
+   IF NOT EXISTS (
+       SELECT FROM pg_catalog.pg_roles WHERE rolname = 'game_app_user'
+   ) THEN
+      CREATE USER game_app_user WITH PASSWORD 'game_app_password';
+   END IF;
+END
+$$;
+
+-- Permissions for app user
+GRANT CONNECT ON DATABASE game_auth TO game_app_user;
+GRANT USAGE ON SCHEMA public TO game_app_user;
+GRANT SELECT, INSERT, UPDATE, DELETE ON TABLE users TO game_app_user;
+
+-- Ensure SERIAL sequence privileges
+DO
+$$
+DECLARE
+    seq_name text;
+BEGIN
+    SELECT pg_get_serial_sequence('users', 'id') INTO seq_name;
+    IF seq_name IS NOT NULL THEN
+        EXECUTE format('GRANT SELECT, UPDATE ON SEQUENCE %I TO game_app_user;', seq_name);
+    END IF;
+END;
+$$;
diff --git a/server.js b/server.js
index 3224b2e..16dfe09 100644
--- a/server.js
+++ b/server.js
@@ -27,16 +27,7 @@ app.use(express.static(path.join(__dirname, 'public')));
 app.use(express.json());
 
 // In-memory rooms data
-// { roomCode: { 
-//     players: [{id, name, score, ready}], 
-//     gameState: 'lobby' | 'question' | 'results' | 'finished',
-//     currentQuestion: {...},
-//     questionIndex: 0,
-//     answers: {socketId: 'A'|'B'|'C'|'D'},
-//     questions: [...],
-//     readyPlayers: Set of socketIds
-// } }
-const rooms = {};
+const rooms = {}; // { roomCode: { players: [{id, name}], isPublic: true/false } }
 
 // Generate random 6-digit code
 function generateRoomCode() {
@@ -54,16 +45,7 @@ app.post('/api/create-room', (req, res) => {
         code = generateRoomCode(); // avoid duplicates
     }
 
-    rooms[code] = { 
-        players: [],
-        gameState: 'lobby',
-        currentQuestion: null,
-        questionIndex: 0,
-        answers: {},
-        questions: [],
-        scores: {},
-        readyPlayers: new Set()
-    };
+    rooms[code] = { players: [] };
     res.json({ ok: true, code });
 
     console.log(`Room ${code} created.`);
@@ -77,21 +59,33 @@ app.post('/api/join-room', (req, res) => {
     }
     res.json({ ok: true, code });
 });
+// API to join or create a public room
+app.post('/api/join-public-room', (req, res) => {
+    const playerName = req.body.playerName || 'Guest';
+
+    // Find existing public room with space
+    let roomCode = Object.keys(rooms).find(code => {
+        const room = rooms[code];
+        return room.isPublic && room.players.length < 8;
+    });
+
+    // If no room available, create one
+    if (!roomCode) {
+        roomCode = generateRoomCode();
+        while (rooms[roomCode]) roomCode = generateRoomCode();
+        rooms[roomCode] = { players: [], isPublic: true };
+        console.log(`New public room ${roomCode} created.`);
+    }
+
+    res.json({ ok: true, code: roomCode });
+});
+
 
 // Socket.IO connection
 io.on('connection', (socket) => {
     socket.on('joinRoom', ({ code, playerName }) => {
         if (!rooms[code]) {
-            rooms[code] = { 
-                players: [],
-                gameState: 'lobby',
-                currentQuestion: null,
-                questionIndex: 0,
-                answers: {},
-                questions: [],
-                scores: {},
-                readyPlayers: new Set()
-            };
+            rooms[code] = { players: [] };
         }
 
         // Check if room is full
@@ -102,24 +96,16 @@ io.on('connection', (socket) => {
 
         // Avoid duplicates
         if (!rooms[code].players.find(p => p.id === socket.id)) {
-            rooms[code].players.push({ id: socket.id, name: playerName, score: 0, ready: false });
-            // Initialize score for this player
-            if (!rooms[code].scores) rooms[code].scores = {};
-            rooms[code].scores[socket.id] = 0;
-            if (!rooms[code].readyPlayers) rooms[code].readyPlayers = new Set();
+            rooms[code].players.push({ id: socket.id, name: playerName });
         }
 
         socket.join(code);
 
         // Broadcast updated players list to all clients in the room
-        const playersWithReady = rooms[code].players.map(p => ({
-            ...p,
-            ready: rooms[code].readyPlayers.has(p.id)
-        }));
-        io.to(code).emit('updatePlayers', playersWithReady);
+        io.to(code).emit('updatePlayers', rooms[code].players);
 
         // Confirm join to client
-        socket.emit('joinSuccess', { code, players: playersWithReady });
+        socket.emit('joinSuccess', { code, players: rooms[code].players });
     });
 
     socket.on('leaveRoom', (code) => {
@@ -132,16 +118,7 @@ io.on('connection', (socket) => {
                 
                 socket.leave(code);
 
-                // Remove from ready players
-                if (room.readyPlayers) {
-                    room.readyPlayers.delete(socket.id);
-                }
-
-                const playersWithReady = room.players.map(p => ({
-                    ...p,
-                    ready: room.readyPlayers.has(p.id)
-                }));
-                io.to(code).emit('updatePlayers', playersWithReady);
+                io.to(code).emit('updatePlayers', room.players);
 
                 if (room.players.length === 0) {
                     delete rooms[code];
@@ -161,17 +138,8 @@ io.on('connection', (socket) => {
                 // Remove the player
                 room.players.splice(index, 1);
 
-                // Remove from ready players
-                if (room.readyPlayers) {
-                    room.readyPlayers.delete(socket.id);
-                }
-
                 // Update all remaining clients in the room
-                const playersWithReady = room.players.map(p => ({
-                    ...p,
-                    ready: room.readyPlayers.has(p.id)
-                }));
-                io.to(code).emit('updatePlayers', playersWithReady);
+                io.to(code).emit('updatePlayers', room.players);
 
                 // If no players left, delete the room entirely
                 if (room.players.length === 0) {
@@ -179,208 +147,10 @@ io.on('connection', (socket) => {
                     console.log(`Room ${code} closed (no players remaining)`);
                 }
 
-            break; // stop once we've found and removed the player
-            }
-        }
-    });
-
-    // Toggle ready status
-    socket.on('toggleReady', ({ code }) => {
-        const room = rooms[code];
-        if (!room || room.gameState !== 'lobby') {
-            return;
-        }
-
-        const player = room.players.find(p => p.id === socket.id);
-        if (!player) return;
-
-        if (!room.readyPlayers) room.readyPlayers = new Set();
-
-        if (room.readyPlayers.has(socket.id)) {
-            room.readyPlayers.delete(socket.id);
-            player.ready = false;
-        } else {
-            room.readyPlayers.add(socket.id);
-            player.ready = true;
-        }
-
-        // Broadcast updated players list
-        const playersWithReady = room.players.map(p => ({
-            ...p,
-            ready: room.readyPlayers.has(p.id)
-        }));
-        io.to(code).emit('updatePlayers', playersWithReady);
-    });
-
-    // Start game event
-    socket.on('startGame', async ({ code }) => {
-        const room = rooms[code];
-        if (!room || room.gameState !== 'lobby') {
-            socket.emit('gameError', 'Cannot start game.');
-            return;
-        }
-
-        // Only host can start (first player)
-        const isHost = room.players[0] && room.players[0].id === socket.id;
-        if (!isHost) {
-            socket.emit('gameError', 'Only the host can start the game.');
-            return;
-        }
-
-        // Check if all players are ready (excluding host - host doesn't need to be ready)
-        const nonHostPlayers = room.players.slice(1);
-        if (nonHostPlayers.length > 0) {
-            const allReady = nonHostPlayers.every(p => room.readyPlayers && room.readyPlayers.has(p.id));
-            if (!allReady) {
-                socket.emit('gameError', 'All players must be ready before starting the game.');
-                return;
-            }
-        }
-
-        try {
-            // Fetch questions from database
-            const result = await pool.query(
-                'SELECT id, question_text, option_a, option_b, option_c, option_d, correct_answer, category FROM questions ORDER BY RANDOM() LIMIT 10'
-            );
-            
-            if (result.rows.length === 0) {
-                socket.emit('gameError', 'No questions available.');
-                return;
+            break; // stop once weâ€™ve found and removed the player
             }
-
-            room.questions = result.rows;
-            room.questionIndex = 0;
-            room.gameState = 'question';
-            room.answers = {};
-            room.scores = {};
-            room.players.forEach(p => room.scores[p.id] = 0);
-
-            // Start with first question
-            room.currentQuestion = room.questions[0];
-            room.currentQuestion.questionNumber = 1;
-            room.currentQuestion.totalQuestions = room.questions.length;
-
-            io.to(code).emit('gameStarted', {
-                question: room.currentQuestion,
-                totalQuestions: room.questions.length
-            });
-
-            console.log(`Game started in room ${code}`);
-        } catch (err) {
-            console.error('Error starting game:', err);
-            socket.emit('gameError', 'Failed to start game.');
-        }
-    });
-
-    // Submit answer event
-    socket.on('submitAnswer', ({ code, answer }) => {
-        const room = rooms[code];
-        if (!room || room.gameState !== 'question') {
-            return;
-        }
-
-        // Check if player already answered
-        if (room.answers[socket.id]) {
-            return; // Already answered
-        }
-
-        // Store answer
-        room.answers[socket.id] = answer;
-        
-        // Check if all players answered
-        const allAnswered = room.players.every(p => room.answers[p.id]);
-        
-        if (allAnswered) {
-            // Wait a bit then show results
-            setTimeout(() => {
-                showResults(code);
-            }, 1000);
         }
     });
-
-    // Function to show results
-    function showResults(code) {
-        const room = rooms[code];
-        if (!room || !room.currentQuestion) return;
-
-        const correctAnswer = room.currentQuestion.correct_answer;
-        const results = room.players.map(player => {
-            const answer = room.answers[player.id];
-            const isCorrect = answer === correctAnswer;
-            
-            if (isCorrect) {
-                room.scores[player.id] = (room.scores[player.id] || 0) + 1;
-                player.score = room.scores[player.id];
-            }
-
-            return {
-                playerId: player.id,
-                playerName: player.name,
-                answer: answer,
-                correct: isCorrect,
-                score: room.scores[player.id] || 0
-            };
-        });
-
-        room.gameState = 'results';
-        
-        io.to(code).emit('showResults', {
-            correctAnswer: correctAnswer,
-            results: results,
-            questionNumber: room.questionIndex + 1,
-            totalQuestions: room.questions.length
-        });
-
-        // Move to next question after 5 seconds
-        setTimeout(() => {
-            nextQuestion(code);
-        }, 5000);
-    }
-
-    // Function to move to next question
-    function nextQuestion(code) {
-        const room = rooms[code];
-        if (!room) return;
-
-        room.questionIndex++;
-        
-        if (room.questionIndex >= room.questions.length) {
-            // Game finished
-            endGame(code);
-            return;
-        }
-
-        room.currentQuestion = room.questions[room.questionIndex];
-        room.currentQuestion.questionNumber = room.questionIndex + 1;
-        room.currentQuestion.totalQuestions = room.questions.length;
-        room.answers = {};
-        room.gameState = 'question';
-
-        io.to(code).emit('nextQuestion', {
-            question: room.currentQuestion,
-            totalQuestions: room.questions.length
-        });
-    }
-
-    // Function to end game
-    function endGame(code) {
-        const room = rooms[code];
-        if (!room) return;
-
-        room.gameState = 'finished';
-        
-        // Get final scores
-        const finalScores = room.players.map(player => ({
-            name: player.name,
-            score: room.scores[player.id] || 0
-        })).sort((a, b) => b.score - a.score);
-
-        io.to(code).emit('gameFinished', {
-            scores: finalScores
-        });
-
-        console.log(`Game finished in room ${code}`);
-    }
 });
 
 // Serve index.html for all other routes
@@ -453,15 +223,4 @@ app.post('/api/register', async (req, res) => {
     }
 });
 
-// API to get questions (optional, for admin/managing questions)
-app.get('/api/questions', async (req, res) => {
-    try {
-        const result = await pool.query('SELECT id, question_text, option_a, option_b, option_c, option_d, correct_answer, category, difficulty FROM questions');
-        res.json({ ok: true, questions: result.rows });
-    } catch (err) {
-        console.error('Database error fetching questions:', err);
-        res.status(500).json({ error: 'Database error' });
-    }
-});
-
 
